include:
  - path:
    - docker-compose._base.yml

services:
  worker:
    extends:
      file: docker-compose._web.yml
      service: web
    entrypoint: ["/data/olympia/docker/entrypoint.sh"]
    command:
      - supervisord -n -c /data/olympia/docker/supervisor-celery.conf
    volumes:
      - .:/data/olympia
      - storage:/data/olympia/storage
      - ./deps:/deps
      - ./package.json:/deps/package.json
      - ./package-lock.json:/deps/package-lock.json
  web:
    extends:
      service: worker
    command:
      - supervisord -n -c /data/olympia/docker/supervisor.conf

